<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Across the Stars</title>
    <link rel="icon" type="image/png" href="Img/estrella.webp">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Secular+One&display=swap" rel="stylesheet">
</head>

<body style="background-image: url('Img/BG1.png'); background-size: cover; background-repeat: no-repeat; background-attachment: fixed;">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } 
        from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

        // Configuraci√≥n de tu proyecto Firebase
        const firebaseConfig = {
        apiKey: "AIzaSyBxZqkPvJMEb8g7TAU8w7YzOEpKuRkAmI8",
        authDomain: "across-the-stars.firebaseapp.com",
        projectId: "across-the-stars",
        storageBucket: "across-the-stars.firebasestorage.app",
        messagingSenderId: "753694056317",
        appId: "1:753694056317:web:abd659d6022ff42b18b614"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Botones
        const btnLogin = document.getElementById("btn-login");
        const btnLogout = document.getElementById("btn-logout");

        // üîë Iniciar sesi√≥n manualmente
        async function login() {
            try {
                const result = await signInWithPopup(auth, provider);
                console.log("‚úÖ Sesi√≥n iniciada:", result.user.email);

                // Guardar usuario
                localStorage.setItem("user", JSON.stringify(result.user));

                // Redirigir SOLO si se us√≥ el login, NO afecta al bot√≥n "Jugar"
                window.location.href = "jugar_multi.html";

            } catch (error) {
                console.error("‚ùå Error en login:", error.code, error.message);
            }
        }

        // üö™ Cerrar sesi√≥n
        async function logout() {
            await signOut(auth);
            localStorage.removeItem("user");
            console.log("üëã Sesi√≥n cerrada.");
        }

        btnLogin.addEventListener("click", login);
        btnLogout.addEventListener("click", logout);

        // üëÄ Mostrar/ocultar botones seg√∫n sesi√≥n
        onAuthStateChanged(auth, (user) => {
            if (user) {
                btnLogin.style.display = "none";
                btnLogout.style.display = "block";
            } else {
                btnLogin.style.display = "block";
                btnLogout.style.display = "none";
            }
        });
    </script>

    <script src="scripts/api/facebook.js"></script>
    
    <h1 class="title">Across the Stars</h1>
    <div class="menu">  
        <a href="modoJ.html" class="btn">Jugar</a>
        <a href="opciones.html" class="btn">Opciones</a>
        <a href="puntuaciones.html" class="btn">Puntuaciones</a>
        <a href="facebook.html" class="btnFacebook">Facebook</a>
        <button id="btn-login">Iniciar sesi√≥n con Google</button>
        <button type="button" id="btn-logout">Logout</button>
    </div>

</body>
</html>